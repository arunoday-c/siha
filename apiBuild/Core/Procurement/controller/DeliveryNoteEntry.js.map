{"version":3,"sources":["../../../../src/Procurement/controller/DeliveryNoteEntry.js"],"names":["config","db","api","post","generateDbConnection","addDeliveryNoteEntry","updatePOEntry","req","res","next","connection","commit","error","rollback","releaseDBConnection","result","records","status","httpStatus","ok","json","success","releaseConnection","get","getDeliveryNoteEntry","getAuthPurchaseList","put","updateDeliveryNoteEntry","results"],"mappings":";;;;;;AAAA;;AACA;;AACA;;;;AACA;;AAOA;;;;kBACe,gBAAoB;AAAA,MAAjBA,MAAiB,QAAjBA,MAAiB;AAAA,MAATC,EAAS,QAATA,EAAS;;AACjC,MAAIC,MAAM,sBAAV;;AAEA;AACAA,MAAIC,IAAJ,CACE,uBADF,EAEEC,2BAFF,EAGEC,uCAHF,EAIEC,gCAJF,EAKE,UAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAClB,QAAIC,aAAaH,IAAIG,UAArB;AACAA,eAAWC,MAAX,CAAkB,iBAAS;AACzB,UAAIC,KAAJ,EAAW;AACT,+BAAS,cAAT,EAAyBA,KAAzB;AACAF,mBAAWG,QAAX,CAAoB,YAAM;AACxBC,8BAAoBb,EAApB,EAAwBS,UAAxB;AACAD,eAAKG,KAAL;AACD,SAHD;AAID,OAND,MAMO;AACL,YAAIG,SAASR,IAAIS,OAAjB;AACA,+BAAS,UAAT,EAAqBD,MAArB;AACAP,YAAIS,MAAJ,CAAWC,qBAAWC,EAAtB,EAA0BC,IAA1B,CAA+B;AAC7BC,mBAAS,IADoB;AAE7BL,mBAASD;AAFoB,SAA/B;AAIAN;AACD;AACF,KAhBD;AAiBD,GAxBH,EAyBEa,wBAzBF;;AA4BA;AACApB,MAAIqB,GAAJ,CACE,uBADF,EAEEC,uCAFF,EAGE,UAACjB,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAClB,QAAIM,SAASR,IAAIS,OAAjB;AACAR,QAAIS,MAAJ,CAAWC,qBAAWC,EAAtB,EAA0BC,IAA1B,CAA+B;AAC7BC,eAAS,IADoB;AAE7BL,eAASD;AAFoB,KAA/B;AAIAN;AACD,GAVH,EAWEa,wBAXF;;AAcA;AACApB,MAAIqB,GAAJ,CACE,sBADF,EAEEE,sCAFF,EAGE,UAAClB,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAClB,QAAIM,SAASR,IAAIS,OAAjB;AACAR,QAAIS,MAAJ,CAAWC,qBAAWC,EAAtB,EAA0BC,IAA1B,CAA+B;AAC7BC,eAAS,IADoB;AAE7BL,eAASD;AAFoB,KAA/B;AAIAN;AACD,GAVH,EAWEa,wBAXF;;AAcA;AACApB,MAAIwB,GAAJ,CACE,0BADF,EAEEC,0CAFF,EAGE,UAACpB,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAClB,QAAImB,UAAUrB,IAAIS,OAAlB;AACAR,QAAIS,MAAJ,CAAWC,qBAAWC,EAAtB,EAA0BC,IAA1B,CAA+B;AAC7BC,eAAS,IADoB;AAE7BL,eAASY;AAFoB,KAA/B;AAIAnB;AACD,GAVH,EAWEa,wBAXF;;AAcA,SAAOpB,GAAP;AACD,C","file":"DeliveryNoteEntry.js","sourcesContent":["import { Router } from \"express\";\nimport { releaseConnection, generateDbConnection } from \"../../utils\";\nimport httpStatus from \"../../utils/httpStatus\";\nimport {\n  addDeliveryNoteEntry,\n  getDeliveryNoteEntry,\n  updateDeliveryNoteEntry,\n  getAuthPurchaseList,\n  updatePOEntry\n} from \"../model/DeliveryNoteEntry\";\nimport { debugFunction, debugLog } from \"../../utils/logging\";\nexport default ({ config, db }) => {\n  let api = Router();\n\n  // created by Nowshad :to add Pharmacy Initial Stock\n  api.post(\n    \"/addDeliveryNoteEntry\",\n    generateDbConnection,\n    addDeliveryNoteEntry,\n    updatePOEntry,\n    (req, res, next) => {\n      let connection = req.connection;\n      connection.commit(error => {\n        if (error) {\n          debugLog(\"Contorller: \", error);\n          connection.rollback(() => {\n            releaseDBConnection(db, connection);\n            next(error);\n          });\n        } else {\n          let result = req.records;\n          debugLog(\"result: \", result);\n          res.status(httpStatus.ok).json({\n            success: true,\n            records: result\n          });\n          next();\n        }\n      });\n    },\n    releaseConnection\n  );\n\n  // created by Nowshad :to getDeliveryNoteEntry\n  api.get(\n    \"/getDeliveryNoteEntry\",\n    getDeliveryNoteEntry,\n    (req, res, next) => {\n      let result = req.records;\n      res.status(httpStatus.ok).json({\n        success: true,\n        records: result\n      });\n      next();\n    },\n    releaseConnection\n  );\n\n  // created by Nowshad :to getAuthrequisitionList\n  api.get(\n    \"/getAuthPurchaseList\",\n    getAuthPurchaseList,\n    (req, res, next) => {\n      let result = req.records;\n      res.status(httpStatus.ok).json({\n        success: true,\n        records: result\n      });\n      next();\n    },\n    releaseConnection\n  );\n\n  // created by Nowshad :update Item Storage\n  api.put(\n    \"/updateDeliveryNoteEntry\",\n    updateDeliveryNoteEntry,\n    (req, res, next) => {\n      let results = req.records;\n      res.status(httpStatus.ok).json({\n        success: true,\n        records: results\n      });\n      next();\n    },\n    releaseConnection\n  );\n\n  return api;\n};\n"]}