{"version":3,"sources":["../../../../src/Inventory/model/inventory.js"],"names":["addItemMaster","req","res","next","db","httpStatus","dataBaseNotInitilizedError","body","input","getConnection","error","connection","beginTransaction","rollback","query","item_code","item_description","item_type","structure_id","category_id","group_id","item_uom_id","purchase_uom_id","sales_uom_id","stocking_uom_id","service_id","addl_information","decimals","purchase_cost","markup_percent","sales_price","Date","created_by","updated_by","result","insertId","insurtColumns","join","sampleInputObject","arrayObj","detail_item_uom","newFieldToInsert","detailResult","commit","records","e","addItemCategory","category_desc","addItemGroup","group_description","addInventoryUom","uom_description","addInventoryLocation","location_description","location_type","allow_pos","getItemMaster","selectWhere","hims_d_inventory_item_master_id","where","condition","values","getItemMasterAndItemUom","getItemCategory","hims_d_inventory_tem_category_id","getItemGroup","hims_d_inventory_item_group_id","getInventoryUom","hims_d_inventory_uom_id","getInventoryLocation","hims_d_inventory_location_id","updateItemCategory","category_status","record_status","release","updateItemGroup","group_status","updateInventoryUom","updateInventoryLocation","location_status","updateItemMasterAndUom","queryBuilder","inputs","item_status","Promise","resolve","reject","insertItemUomMap","length","insertUomMapResult","then","updateUomMapResult","inputParam","qry","i","item_master_id","uom_id","stocking_uom","conversion_factor","toLocaleString","hims_m_inventory_item_uom_id","results","addLocationPermission","user_id","location_id","allow","getLocationPermission","hims_m_inventory_location_permission_id","updateLocationPermission","module","exports"],"mappings":"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","file":"inventory.js","sourcesContent":["\"use strict\";\nimport {\n  whereCondition,\n  releaseDBConnection,\n  jsonArrayToObject\n} from \"../../utils\";\nimport extend from \"extend\";\nimport httpStatus from \"../../utils/httpStatus\";\nimport { debugFunction, debugLog } from \"../../utils/logging\";\n\n//created by Nowshad: to add in itemMaster\nlet  addItemMaster = (req, res, next) => {\n  try {\n    if (req.db == null) {\n      next(httpStatus.dataBaseNotInitilizedError());\n    }\n    let db = req.db;\n    debugLog(\"Body: \", req.body);\n\n    let input = extend({}, req.body);\n\n    db.getConnection((error, connection) => {\n      if (error) {\n        next(error);\n      }\n      connection.beginTransaction(error => {\n        if (error) {\n          connection.rollback(() => {\n            releaseDBConnection(db, connection);\n            next(error);\n          });\n        }\n        connection.query(\n          \"INSERT INTO `hims_d_inventory_item_master` (`item_code`, `item_description`,item_type, `structure_id`,\\\n          `category_id`, `group_id`, `item_uom_id`, `purchase_uom_id`, `sales_uom_id`, `stocking_uom_id`, `service_id`,\\\n          addl_information,decimals, purchase_cost, markup_percent, sales_price, \\\n         `created_date`, `created_by`, `update_date`, `updated_by`)\\\n        VALUE(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\",\n          [\n            input.item_code,\n            input.item_description,\n            input.item_type,\n            input.structure_id,\n            input.category_id,\n            input.group_id,\n            input.item_uom_id,\n            input.purchase_uom_id,\n            input.sales_uom_id,\n            input.stocking_uom_id,\n            input.service_id,\n            input.addl_information,\n            input.decimals,\n            input.purchase_cost,\n            input.markup_percent,\n            input.sales_price,\n\n\n\n            new Date(),\n            input.created_by,\n            new Date(),\n            input.updated_by\n          ],\n          (error, result) => {\n            if (error) {\n              connection.rollback(() => {\n                releaseDBConnection(db, connection);\n                next(error);\n              });\n            }\n\n            debugLog(\" item master id :\", result.insertId);\n            // req.records = spResult;\n            // next();\n\n            if (result.insertId != null) {\n              const insurtColumns = [\n                \"uom_id\",\n                \"stocking_uom\",\n                \"conversion_factor\",\n                \"created_by\",\n                \"updated_by\"\n              ];\n\n              connection.query(\n                \"INSERT INTO hims_m_inventory_item_uom(\" +\n                  insurtColumns.join(\",\") +\n                  \",item_master_id,created_date,updated_date) VALUES ?\",\n                [\n                  jsonArrayToObject({\n                    sampleInputObject: insurtColumns,\n                    arrayObj: req.body.detail_item_uom,\n                    newFieldToInsert: [result.insertId, new Date(), new Date()],\n                    req: req\n                  })\n                ],\n                (error, detailResult) => {\n                  if (error) {\n                    connection.rollback(() => {\n                      releaseDBConnection(db, connection);\n                      next(error);\n                    });\n                  }\n\n                  connection.commit(error => {\n                    if (error) {\n                      connection.rollback(() => {\n                        releaseDBConnection(db, connection);\n                        next(error);\n                      });\n                    }\n                    releaseDBConnection(db, connection);\n                    req.records = detailResult;\n                    next();\n                  });\n                }\n              );\n            } else {\n              connection.rollback(() => {\n                releaseDBConnection(db, connection);\n                next(error);\n              });\n            }\n          }\n        );\n      });\n    });\n  } catch (e) {\n    next(e);\n  }\n};\n\n//created by Nowshad: to add ItemCategory\nlet addItemCategory = (req, res, next) => {\n  try {\n    if (req.db == null) {\n      next(httpStatus.dataBaseNotInitilizedError());\n    }\n    let db = req.db;\n    let input = extend({}, req.body);\n\n    db.getConnection((error, connection) => {\n      if (error) {\n        next(error);\n      }\n\n      connection.query(\n        \"INSERT INTO `hims_d_inventory_tem_category` (`category_desc`, `created_date`, `created_by`, `updated_date`, `updated_by`)\\\n        VALUE(?,?,?,?,?)\",\n        [\n          input.category_desc,\n          new Date(),\n          input.created_by,\n          new Date(),\n          input.updated_by\n        ],\n        (error, result) => {\n          releaseDBConnection(db, connection);\n          if (error) {\n            next(error);\n          }\n          req.records = result;\n          next();\n        }\n      );\n    });\n  } catch (e) {\n    next(e);\n  }\n};\n\n//created by Nowshad: to add  item group\nlet addItemGroup = (req, res, next) => {\n  try {\n    if (req.db == null) {\n      next(httpStatus.dataBaseNotInitilizedError());\n    }\n    let db = req.db;\n    let input = extend({}, req.body);\n\n    db.getConnection((error, connection) => {\n      if (error) {\n        next(error);\n      }\n\n      connection.query(\n        \"INSERT INTO `hims_d_inventory_item_group` (`group_description`, `category_id`, `created_by`, `created_date`, `updated_by`, `updated_date`) \\\n        VALUE(?,?,?,?,?,?)\",\n        [\n          input.group_description,\n          input.category_id,\n          input.created_by,\n          new Date(),\n          input.updated_by,\n          new Date()\n        ],\n        (error, result) => {\n          releaseDBConnection(db, connection);\n          if (error) {\n            next(error);\n          }\n          req.records = result;\n          next();\n        }\n      );\n    });\n  } catch (e) {\n    next(e);\n  }\n};\n\n//created by Nowshad: to add   add Inventory Uom\nlet addInventoryUom = (req, res, next) => {\n  try {\n    if (req.db == null) {\n      next(httpStatus.dataBaseNotInitilizedError());\n    }\n    let db = req.db;\n    let input = extend({}, req.body);\n\n    db.getConnection((error, connection) => {\n      if (error) {\n        next(error);\n      }\n\n      connection.query(\n        \"INSERT INTO `hims_d_inventory_uom` (`uom_description`, `created_date`, `created_by`, `updated_date`, `updated_by`)\\\n        VALUE(?,?,?,?,?)\",\n        [\n          input.uom_description,\n          new Date(),\n          input.created_by,\n          new Date(),\n          input.updated_by\n        ],\n        (error, result) => {\n          releaseDBConnection(db, connection);\n          if (error) {\n            next(error);\n          }\n          req.records = result;\n          next();\n        }\n      );\n    });\n  } catch (e) {\n    next(e);\n  }\n};\n\n//created by Nowshad: to add   Inventory Location\nlet addInventoryLocation = (req, res, next) => {\n  try {\n    if (req.db == null) {\n      next(httpStatus.dataBaseNotInitilizedError());\n    }\n    let db = req.db;\n    let input = extend({}, req.body);\n\n    db.getConnection((error, connection) => {\n      if (error) {\n        next(error);\n      }\n\n      connection.query(\n        \"INSERT INTO `hims_d_inventory_location` (`location_description`,  `location_type`, `allow_pos`, `created_date`, `created_by`, `updated_date`, `updated_by`)\\\n        VALUE(?,?,?,?,?,?,?)\",\n        [\n          input.location_description,\n          input.location_type,\n          input.allow_pos,\n          new Date(),\n          input.created_by,\n          new Date(),\n          input.updated_by\n        ],\n        (error, result) => {\n          releaseDBConnection(db, connection);\n          if (error) {\n            next(error);\n          }\n          req.records = result;\n          next();\n        }\n      );\n    });\n  } catch (e) {\n    next(e);\n  }\n};\n\n//created by Nowshad: to get item master\nlet getItemMaster = (req, res, next) => {\n  let selectWhere = {\n    hims_d_inventory_item_master_id: \"ALL\"\n  };\n  try {\n    if (req.db == null) {\n      next(httpStatus.dataBaseNotInitilizedError());\n    }\n    let db = req.db;\n\n    let where = whereCondition(extend(selectWhere, req.query));\n\n    db.getConnection((error, connection) => {\n      connection.query(\n        \"select * FROM hims_d_inventory_item_master where record_status='A' AND\" +\n          where.condition,\n        where.values,\n        (error, result) => {\n          releaseDBConnection(db, connection);\n          if (error) {\n            next(error);\n          }\n          req.records = result;\n          next();\n        }\n      );\n    });\n  } catch (e) {\n    next(e);\n  }\n};\n\n//created by Nowshad: to get ItemMaster And ItemUom\nlet getItemMasterAndItemUom = (req, res, next) => {\n  try {\n    if (req.db == null) {\n      next(httpStatus.dataBaseNotInitilizedError());\n    }\n    let db = req.db;\n\n    db.getConnection((error, connection) => {\n      connection.query(\n        \"select  MIU.hims_m_inventory_item_uom_id, MIU.item_master_id, MIU.uom_id,PH.uom_description, MIU.stocking_uom, \\\n        MIU.conversion_factor,IM.hims_d_inventory_item_master_id, IM.item_code, IM.item_description, IM.structure_id, \\\n        IM.category_id,IM.group_id, IM.item_uom_id, IM.purchase_uom_id, IM.sales_uom_id, IM.stocking_uom_id, \\\n        IM.item_status, IM.service_id from  hims_d_inventory_item_master IM left join \\\n        hims_m_inventory_item_uom MIU on IM.hims_d_inventory_item_master_id=MIU.item_master_id and IM.record_status='A' and MIU.record_status='A' \\\n        left join hims_d_inventory_uom PH  on  MIU.uom_id=PH.hims_d_inventory_uom_id;\",\n        (error, result) => {\n          releaseDBConnection(db, connection);\n          if (error) {\n            next(error);\n          }\n          req.records = result;\n          next();\n        }\n      );\n    });\n  } catch (e) {\n    next(e);\n  }\n};\n\n//created by Nowshad: to get item category\nlet getItemCategory = (req, res, next) => {\n  let selectWhere = {\n    hims_d_inventory_tem_category_id: \"ALL\"\n  };\n  try {\n    if (req.db == null) {\n      next(httpStatus.dataBaseNotInitilizedError());\n    }\n    let db = req.db;\n\n    let where = whereCondition(extend(selectWhere, req.query));\n\n    db.getConnection((error, connection) => {\n      connection.query(\n        \"select * FROM hims_d_inventory_tem_category where record_status='A' AND\" +\n          where.condition,\n        where.values,\n        (error, result) => {\n          releaseDBConnection(db, connection);\n          if (error) {\n            next(error);\n          }\n          req.records = result;\n          next();\n        }\n      );\n    });\n  } catch (e) {\n    next(e);\n  }\n};\n\n//created by Nowshad: to get item Group\nlet getItemGroup = (req, res, next) => {\n  let selectWhere = {\n    hims_d_inventory_item_group_id: \"ALL\"\n  };\n  try {\n    if (req.db == null) {\n      next(httpStatus.dataBaseNotInitilizedError());\n    }\n    let db = req.db;\n\n    let where = whereCondition(extend(selectWhere, req.query));\n\n    db.getConnection((error, connection) => {\n      connection.query(\n        \"select * FROM hims_d_inventory_item_group where record_status='A' AND\" +\n          where.condition,\n        where.values,\n        (error, result) => {\n          releaseDBConnection(db, connection);\n          if (error) {\n            next(error);\n          }\n          req.records = result;\n          next();\n        }\n      );\n    });\n  } catch (e) {\n    next(e);\n  }\n};\n\n//created by Nowshad: to get get Inventory Uom\nlet getInventoryUom = (req, res, next) => {\n  let selectWhere = {\n    hims_d_inventory_uom_id: \"ALL\"\n  };\n  try {\n    if (req.db == null) {\n      next(httpStatus.dataBaseNotInitilizedError());\n    }\n    let db = req.db;\n\n    let where = whereCondition(extend(selectWhere, req.query));\n\n    db.getConnection((error, connection) => {\n      connection.query(\n        \"select * FROM hims_d_inventory_uom where record_status='A' AND \" +\n          where.condition,\n        where.values,\n        (error, result) => {\n          releaseDBConnection(db, connection);\n          if (error) {\n            next(error);\n          }\n          req.records = result;\n          next();\n        }\n      );\n    });\n  } catch (e) {\n    next(e);\n  }\n};\n\n//created by Nowshad: to get Inventory Location\nlet getInventoryLocation = (req, res, next) => {\n  let selectWhere = {\n    hims_d_inventory_location_id: \"ALL\"\n  };\n  try {\n    if (req.db == null) {\n      next(httpStatus.dataBaseNotInitilizedError());\n    }\n    let db = req.db;\n\n    let where = whereCondition(extend(selectWhere, req.query));\n\n    db.getConnection((error, connection) => {\n      connection.query(\n        \"select * FROM hims_d_inventory_location where record_status='A' AND\" +\n          where.condition,\n        where.values,\n        (error, result) => {\n          releaseDBConnection(db, connection);\n          if (error) {\n            next(error);\n          }\n          req.records = result;\n          next();\n        }\n      );\n    });\n  } catch (e) {\n    next(e);\n  }\n};\n\n//created by Nowshad: to updateItemCategory\nlet updateItemCategory = (req, res, next) => {\n  try {\n    if (req.db == null) {\n      next(httpStatus.dataBaseNotInitilizedError());\n    }\n    let db = req.db;\n    let input = extend({}, req.body);\n    db.getConnection((error, connection) => {\n      if (error) {\n        next(error);\n      }\n      connection.query(\n        \"UPDATE `hims_d_inventory_tem_category` SET `category_desc`=?, `category_status`=?,\\\n        `updated_date`=?, `updated_by`=?, `record_status`=?\\\n        WHERE `hims_d_inventory_tem_category_id`=? and `record_status`='A';\",\n        [\n          input.category_desc,\n          input.category_status,\n          new Date(),\n          input.updated_by,\n          input.record_status,\n          input.hims_d_inventory_tem_category_id\n        ],\n        (error, result) => {\n          connection.release();\n          if (error) {\n            next(error);\n          }\n          req.records = result;\n          next();\n        }\n      );\n    });\n  } catch (e) {\n    next(e);\n  }\n};\n\n//created by Nowshad: to updateItemGroup\nlet updateItemGroup = (req, res, next) => {\n  try {\n    if (req.db == null) {\n      next(httpStatus.dataBaseNotInitilizedError());\n    }\n    let db = req.db;\n    let input = extend({}, req.body);\n    db.getConnection((error, connection) => {\n      if (error) {\n        next(error);\n      }\n      connection.query(\n        \"UPDATE `hims_d_inventory_item_group` SET `group_description`=?, `category_id`=?, `group_status`=?,\\\n        `updated_by`=?, `updated_date`=?, `record_status`=? WHERE  `record_status`='A' and `hims_d_inventory_item_group_id`=?;\",\n        [\n          input.group_description,\n          input.category_id,\n          input.group_status,\n          input.updated_by,\n          new Date(),\n          input.record_status,\n          input.hims_d_inventory_item_group_id\n        ],\n        (error, result) => {\n          connection.release();\n          if (error) {\n            next(error);\n          }\n          req.records = result;\n          next();\n        }\n      );\n    });\n  } catch (e) {\n    next(e);\n  }\n};\n\n//created by Nowshad: to update Inventory Uom\nlet updateInventoryUom = (req, res, next) => {\n  try {\n    if (req.db == null) {\n      next(httpStatus.dataBaseNotInitilizedError());\n    }\n    let db = req.db;\n    let input = extend({}, req.body);\n    db.getConnection((error, connection) => {\n      if (error) {\n        next(error);\n      }\n      connection.query(\n        \"UPDATE `hims_d_inventory_uom` SET `uom_description`=?,\\\n        `updated_date`=?, `updated_by`=?, `record_status`=? WHERE record_status='A' and`hims_d_inventory_uom_id`=?;\",\n        [\n          input.uom_description,\n          new Date(),\n          input.updated_by,\n          input.record_status,\n          input.hims_d_inventory_uom_id\n        ],\n        (error, result) => {\n          connection.release();\n          if (error) {\n            next(error);\n          }\n          req.records = result;\n          next();\n        }\n      );\n    });\n  } catch (e) {\n    next(e);\n  }\n};\n\n//created by Nowshad: to update Inventory Location\nlet updateInventoryLocation = (req, res, next) => {\n  try {\n    if (req.db == null) {\n      next(httpStatus.dataBaseNotInitilizedError());\n    }\n    let db = req.db;\n    let input = extend({}, req.body);\n    db.getConnection((error, connection) => {\n      if (error) {\n        next(error);\n      }\n      connection.query(\n        \"UPDATE `hims_d_inventory_location` SET `location_description`=?, `location_status`=?, `location_type`=?, `allow_pos`=?,\\\n         `updated_date`=?,`updated_by`=?, `record_status`=? WHERE `record_status`='A' and `hims_d_inventory_location_id`=?;\",\n        [\n          input.location_description,\n          input.location_status,\n          input.location_type,\n          input.allow_pos,\n          new Date(),\n          input.updated_by,\n          input.record_status,\n          input.hims_d_inventory_location_id\n        ],\n        (error, result) => {\n          connection.release();\n          if (error) {\n            next(error);\n          }\n          req.records = result;\n          next();\n        }\n      );\n    });\n  } catch (e) {\n    next(e);\n  }\n};\n\n//created by:Nowshad,to update Item Master And Uom\nlet updateItemMasterAndUom = (req, res, next) => {\n  try {\n    debugFunction(\"updateItemMasterAndUom \");\n    if (req.db == null) {\n      next(httpStatus.dataBaseNotInitilizedError());\n    }\n    let db = req.db;\n\n    let input = extend({}, req.body);\n    debugLog(\"Input body\", input);\n    db.getConnection((error, connection) => {\n      if (error) {\n        next(error);\n      }\n      connection.beginTransaction(error => {\n        if (error) {\n          connection.rollback(() => {\n            releaseDBConnection(db, connection);\n            next(error);\n          });\n        }\n        let queryBuilder =\n          \"UPDATE `hims_d_inventory_item_master` SET `item_code`=?, `item_description`=?, `structure_id`=?,\\\n          `category_id`=?, `group_id`=?,`item_uom_id`=?,\\\n           `purchase_uom_id`=?, `sales_uom_id`=?, `stocking_uom_id`=?, `item_status`=?, `service_id`=?,\\\n            item_type=?, addl_information=?, decimals=?, purchase_cost=?, markup_percent=?, sales_price=?,\\\n            `update_date`=?, `updated_by`=?, `record_status`=? WHERE record_status='A' and\\\n           `hims_d_inventory_item_master_id`=?\";\n        let inputs = [\n          input.item_code,\n          input.item_description,\n          input.structure_id,\n          input.category_id,\n          input.group_id,\n          input.item_uom_id,\n          input.purchase_uom_id,\n          input.sales_uom_id,\n          input.stocking_uom_id,\n          input.item_status,\n          input.service_id,\n          input.item_type,\n          input.addl_information,\n          input.decimals,\n          input.purchase_cost,\n          input.markup_percent,\n          input.sales_price,\n\n\n          new Date(),\n          input.updated_by,\n          input.record_status,\n          input.hims_d_inventory_item_master_id\n        ];\n\n        connection.query(queryBuilder, inputs, (error, result) => {\n          if (error) {\n            connection.rollback(() => {\n              releaseDBConnection(db, connection);\n              next(error);\n            });\n          }\n\n          if (result != null) {\n            new Promise((resolve, reject) => {\n              try {\n                if (input.insertItemUomMap.length != 0) {\n                  const insurtColumns = [\n                    \"uom_id\",\n                    \"item_master_id\",\n                    \"stocking_uom\",\n                    \"conversion_factor\",\n                    \"created_by\",\n                    \"updated_by\"\n                  ];\n\n                  connection.query(\n                    \"INSERT INTO hims_m_inventory_item_uom(\" +\n                      insurtColumns.join(\",\") +\n                      \",created_date,updated_date) VALUES ?\",\n                    [\n                      jsonArrayToObject({\n                        sampleInputObject: insurtColumns,\n                        arrayObj: req.body.insertItemUomMap,\n                        newFieldToInsert: [new Date(), new Date()],\n                        req: req\n                      })\n                    ],\n                    (error, insertUomMapResult) => {\n                      if (error) {\n                        connection.rollback(() => {\n                          releaseDBConnection(db, connection);\n                          next(error);\n                        });\n                      }\n                      return resolve(insertUomMapResult);\n                    }\n                  );\n                } else {\n                  return resolve();\n                }\n              } catch (e) {\n                reject(e);\n              }\n            }).then(results => {\n              debugLog(\"inside uom map then\");\n\n              if (input.updateUomMapResult.length != 0) {\n                let inputParam = extend([], req.body.updateUomMapResult);\n\n                let qry = \"\";\n\n                for (let i = 0; i < req.body.updateUomMapResult.length; i++) {\n                  qry +=\n                    \"UPDATE `hims_m_inventory_item_uom` SET item_master_id='\" +\n                    inputParam[i].item_master_id +\n                    \"', uom_id='\" +\n                    inputParam[i].uom_id +\n                    \"', stocking_uom='\" +\n                    inputParam[i].stocking_uom +\n                    \"', conversion_factor='\" +\n                    inputParam[i].conversion_factor +\n                    \"', record_status='\" +\n                    inputParam[i].record_status +\n                    \"', updated_date='\" +\n                    new Date().toLocaleString() +\n                    \"',updated_by='\" +\n                    req.body.updated_by +\n                    \"' WHERE record_status='A' and hims_m_inventory_item_uom_id='\" +\n                    inputParam[i].hims_m_inventory_item_uom_id +\n                    \"';\";\n                }\n\n                connection.query(qry, (error, updateUomMapResult) => {\n                  if (error) {\n                    connection.rollback(() => {\n                      releaseDBConnection(db, connection);\n                      next(error);\n                    });\n                  }\n\n                  connection.commit(error => {\n                    if (error) {\n                      connection.rollback(() => {\n                        releaseDBConnection(db, connection);\n                        next(error);\n                      });\n                    }\n                    releaseDBConnection(db, connection);\n                    req.records = updateUomMapResult;\n                    next();\n                  });\n                });\n              } else {\n                connection.commit(error => {\n                  if (error) {\n                    connection.rollback(() => {\n                      releaseDBConnection(db, connection);\n                      next(error);\n                    });\n                  }\n                  releaseDBConnection(db, connection);\n                  req.records = results;\n                  next();\n                });\n              }\n            });\n          } else {\n            connection.commit(error => {\n              if (error) {\n                connection.rollback(() => {\n                  releaseDBConnection(db, connection);\n                  next(error);\n                });\n              }\n              releaseDBConnection(db, connection);\n              req.records = result;\n              next();\n            });\n          }\n        });\n      });\n    });\n  } catch (e) {\n    next(e);\n  }\n};\n\n//Location Permission\n//created by Nowshad: to add Location Permission\nlet addLocationPermission = (req, res, next) => {\n  try {\n    if (req.db == null) {\n      next(httpStatus.dataBaseNotInitilizedError());\n    }\n    let db = req.db;\n    let input = extend({}, req.body);\n\n    db.getConnection((error, connection) => {\n      if (error) {\n        next(error);\n      }\n\n      connection.query(\n        \"INSERT INTO `hims_m_inventory_location_permission` (`user_id`, `location_id`, `allow`,`created_date`,`created_by`)\\\n        VALUE(?,?,?,?,?)\",\n        [\n          input.user_id,\n          input.location_id,\n          input.allow,\n          new Date(),\n          input.created_by\n        ],\n        (error, result) => {\n          releaseDBConnection(db, connection);\n          if (error) {\n            next(error);\n          }\n          req.records = result;\n          next();\n        }\n      );\n    });\n  } catch (e) {\n    next(e);\n  }\n};\n\n//created by Nowshad: to get Location Permission\nlet getLocationPermission = (req, res, next) => {\n  let selectWhere = {\n    hims_m_inventory_location_permission_id: \"ALL\"\n  };\n\n  try {\n    if (req.db == null) {\n      next(httpStatus.dataBaseNotInitilizedError());\n    }\n    let db = req.db;\n\n    let where = whereCondition(extend(selectWhere, req.query));\n\n    db.getConnection((error, connection) => {\n      connection.query(\n        \"select * FROM hims_m_inventory_location_permission where record_status='A' AND\" +\n          where.condition,\n        where.values,\n        (error, result) => {\n          releaseDBConnection(db, connection);\n          if (error) {\n            next(error);\n          }\n          req.records = result;\n          next();\n        }\n      );\n    });\n  } catch (e) {\n    next(e);\n  }\n};\n\n//created by Nowshad: to update Location Permission\nlet updateLocationPermission = (req, res, next) => {\n  try {\n    if (req.db == null) {\n      next(httpStatus.dataBaseNotInitilizedError());\n    }\n    let db = req.db;\n    let input = extend({}, req.body);\n    db.getConnection((error, connection) => {\n      if (error) {\n        next(error);\n      }\n\n      connection.query(\n        \"UPDATE `hims_m_inventory_location_permission` SET `user_id`=?, `location_id`=?,\\\n        `allow`=?, `updated_date`=?, `updated_by`=?, `record_status`=?\\\n        WHERE `hims_m_inventory_location_permission_id`=? and `record_status`='A';\",\n        [\n          input.user_id,\n          input.location_id,\n          input.allow,\n          new Date(),\n          input.updated_by,\n          input.record_status,\n          input.hims_m_inventory_location_permission_id\n        ],\n        (error, result) => {\n          connection.release();\n          if (error) {\n            next(error);\n          }\n          req.records = result;\n          next();\n        }\n      );\n    });\n  } catch (e) {\n    next(e);\n  }\n};\n\nmodule.exports = {\n  addItemMaster,\n  addItemCategory,\n  addItemGroup,\n  addInventoryUom,\n  addInventoryLocation,\n  addLocationPermission,\n\n  getItemMaster,\n  getItemCategory,\n  getItemGroup,\n  getInventoryUom,\n  getInventoryLocation,\n  getLocationPermission,\n\n  updateItemCategory,\n  updateItemGroup,\n  updateInventoryUom,\n  updateInventoryLocation,\n  getItemMasterAndItemUom,\n  updateItemMasterAndUom,\n  updateLocationPermission\n};\n"]}