{"version":3,"sources":["../../../src/model/visitType.js"],"names":["selectStatement","req","res","next","whereStatement","hims_d_visit_type_id","visit_type_code","visit_type_desc","db","httpStatus","dataBaseNotInitilizedError","getConnection","error","connection","where","query","condition","values","result","records","e","addVisit","visitType","consultation","created_by","userIdentity","algaeh_d_app_user_id","updated_by","visit_status","inputParam","body","arabic_visit_type_desc","Date","updateVisit","deleteVisitType","tableName","id","module","exports"],"mappings":"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","file":"visitType.js","sourcesContent":["import extend from \"extend\";\nimport { whereCondition, releaseDBConnection, deleteRecord } from \"../utils\";\nimport httpStatus from \"../utils/httpStatus\";\n\nlet selectStatement = (req, res, next) => {\n  let whereStatement = {\n    hims_d_visit_type_id: \"ALL\",\n    visit_type_code: \"ALL\",\n    visit_type_desc: \"ALL\"\n  };\n  try {\n    if (req.db == null) {\n      next(httpStatus.dataBaseNotInitilizedError());\n    }\n    let db = req.db;\n    db.getConnection((error, connection) => {\n      if (error) {\n        next(error);\n      }\n      let where = whereCondition(extend(whereStatement, req.query));\n      connection.query(\n        \"SELECT `hims_d_visit_type_id`, `visit_type_code`, `visit_type_desc`,`visit_status`,`arabic_visit_type_desc`\\\n       , `consultation`, `created_by`, `created_date`, `updated_by`, `updated_date` FROM `hims_d_visit_type`  \\\n       WHERE record_status='A' AND \" +\n          where.condition+\" order by hims_d_visit_type_id desc\",\n        where.values,\n        (error, result) => {\n          releaseDBConnection(db, connection);\n          if (error) {\n            next(error);\n          }\n          req.records = result;\n          next();\n        }\n      );\n    });\n  } catch (e) {\n    next(e);\n  }\n};\n\nlet addVisit = (req, res, next) => {\n  let visitType = {\n    hims_d_visit_type_id: null,\n    visit_type_code: null,\n    visit_type_desc: null,\n    consultation: null,\n    created_by: req.userIdentity.algaeh_d_app_user_id,\n\n    updated_by: req.userIdentity.algaeh_d_app_user_id,\n\n    visit_status: \"A\"\n  };\n\n  if (req.db == null) {\n    next(httpStatus.dataBaseNotInitilizedError());\n  }\n  let db = req.db;\n  db.getConnection((error, connection) => {\n    if (error) {\n      next(error);\n    }\n    let inputParam = extend(visitType, req.body);\n    connection.query(\n      \"INSERT INTO `hims_d_visit_type` (`visit_type_code`, `visit_type_desc`,`arabic_visit_type_desc`, `consultation` \\\n      , `created_by` ,`created_date`,`visit_status`) \\\n   VALUES ( ?, ?, ?, ?, ?, ?, ?)\",\n      [\n        inputParam.visit_type_code,\n        inputParam.visit_type_desc,\n        inputParam.arabic_visit_type_desc,\n        inputParam.consultation,\n        inputParam.created_by,\n        new Date(),\n        inputParam.visit_status\n      ],\n      (error, result) => {\n        releaseDBConnection(db, connection);\n        if (error) {\n          next(error);\n        }\n        req.records = result;\n        next();\n      }\n    );\n  });\n};\n\nlet updateVisit = (req, res, next) => {\n  let visitType = {\n    hims_d_visit_type_id: null,\n    visit_type_code: null,\n    visit_type_desc: null,\n    consultation: null,\n    created_by: req.userIdentity.algaeh_d_app_user_id,\n\n    updated_by: req.userIdentity.algaeh_d_app_user_id,\n\n    visit_status: \"A\"\n  };\n  if (req.db == null) {\n    next(httpStatus.dataBaseNotInitilizedError());\n  }\n  let db = req.db;\n  db.getConnection((error, connection) => {\n    if (error) {\n      next(error);\n    }\n    let inputParam = extend(visitType, req.body);\n    connection.query(\n      \"UPDATE `hims_d_visit_type` \\\n     SET `visit_type_desc`=?,  `arabic_visit_type_desc`=?,`consultation`=?, `updated_by`=?, `updated_date`=?,visit_status=? \\\n     WHERE `record_status`='A' and `hims_d_visit_type_id`=?\",\n      [\n        inputParam.visit_type_desc,\n        inputParam.arabic_visit_type_desc,\n        inputParam.consultation,\n        inputParam.updated_by,\n        new Date(),\n        inputParam.visit_status,\n        inputParam.hims_d_visit_type_id\n      ],\n      (error, result) => {\n        releaseDBConnection(db, connection);\n        if (error) {\n          next(error);\n        }\n        req.records = result;\n        next();\n      }\n    );\n  });\n};\nlet deleteVisitType = (req, res, next) => {\n  try {\n    if (req.db == null) {\n      next(httpStatus.dataBaseNotInitilizedError());\n    }\n    deleteRecord(\n      {\n        db: req.db,\n        tableName: \"hims_d_visit_type\",\n        id: req.body.hims_d_visit_type_id,\n        query:\n          \"UPDATE hims_d_visit_type SET  record_status='I', \\\n         updated_by=?,updated_date=? WHERE hims_d_visit_type_id=?\",\n        values: [req.body.updated_by, new Date(), req.body.hims_d_visit_type_id]\n      },\n      result => {\n        req.records = result;\n        next();\n      },\n      error => {\n        next(error);\n      },\n      true\n    );\n  } catch (e) {\n    next(e);\n  }\n};\n\nmodule.exports = {\n  selectStatement,\n  addVisit,\n  updateVisit,\n  deleteVisitType\n};\n"]}